

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>极限中心定理 &#8212; Austin&#39;s Jupyter Notes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Math" href="Math.jupyter.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Austin's Jupyter Notes</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="../_jbook/intro.html">Welcome</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Packages</p>
</li>
  <li class="">
    <a href="../matplotlib.jupyter.html">Matplotlib</a>
  </li>
  <li class="">
    <a href="../Python.jupyter.html">python</a>
  </li>
  <li class="">
    <a href="../numpy/numpy.jupyter.html">Numpy</a>
  </li>
  <li class="">
    <a href="../sympy.jupyter.html">sympy</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Maths</p>
</li>
  <li class="active">
    <a href="Math.jupyter.html">Math</a>
  <ul class="nav sidenav_l2">
    <li class="active">
      <a href="">极限中心定理</a>
    </li>
  </ul>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="../_sources/Math/中心极限定理.jupyter.ipynb"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.ipynb</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Source interaction buttons -->
        

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#z-score" class="nav-link">1 方差与z-score标准化</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#id2" class="nav-link">1.1 z-score证明</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#id3" class="nav-link">2 标准正太分布</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#id4" class="nav-link">2.1 z-score变换为标准正态分布</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#id5" class="nav-link">3 中心极限定理</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#id6" class="nav-link">3.1 名词解释</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#id7" class="nav-link">3.2 定义</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#id8" class="nav-link">3.3 单次采样</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#id9" class="nav-link">3.3.1 均匀分布</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#id10" class="nav-link">3.3.2 偏正态分布</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#id11" class="nav-link">3.4 多次采样</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#id12" class="nav-link">3.4.1 均匀分布</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#id13" class="nav-link">3.4.2 偏正态分布</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#id14" class="nav-link">3.5 练习题</a>
        </li>
    
            </ul>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="id1">
<h1>极限中心定理<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="z-score">
<h2>1 方差与z-score标准化<a class="headerlink" href="#z-score" title="Permalink to this headline">¶</a></h2>
<p>方差公式<span class="math notranslate nohighlight">\(V[X]=E\left((X-E(X))^{2}\right)\)</span>，也表示为<span class="math notranslate nohighlight">\(\sigma^{2}=\frac{\sum(X-\mu)^{2}}{N}\)</span>。</p>
<p>方差描述的是分布的离散程度，方差为0时则<span class="math notranslate nohighlight">\(X=E(X)\)</span>，即分布不含有任何随机的成分。</p>
<p>由于数据加常量后其方差<span class="math notranslate nohighlight">\(\sigma^2\)</span>不变，乘以<span class="math notranslate nohighlight">\(n\)</span>后则变为<span class="math notranslate nohighlight">\(n^2\sigma^2\)</span>，所以对任何分布的数据都可以做一个标准化（z-score），使得方差<span class="math notranslate nohighlight">\(\sigma^2=1\)</span>，期望<span class="math notranslate nohighlight">\(\mu=0\)</span>。具体做法为：</p>
<p><span class="math notranslate nohighlight">\(W=\frac{X-\mu}{\sigma}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">axs1</span><span class="p">,</span> <span class="n">axs2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">axs1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">axs1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">axs2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mean:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;std:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/中心极限定理.jupyter_1_0.png" src="../_images/中心极限定理.jupyter_1_0.png" />
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>mean: 0.5 std: 0.29
</pre></div>
</div>
</div>
</div>
<p>进行z-score标准化<span class="math notranslate nohighlight">\(z=\frac{x-\mu}{\sigma}\)</span>操作（证明过程见下一小节）</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">W</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">X</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">/</span><span class="n">X</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="n">mean</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_var</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">axs1</span><span class="p">,</span> <span class="n">axs2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">axs1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">axs1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">axs2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mean:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">W</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;std:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">W</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/中心极限定理.jupyter_3_0.png" src="../_images/中心极限定理.jupyter_3_0.png" />
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>mean: -0.0 std: 1.0
</pre></div>
</div>
</div>
</div>
<p>打印的信息显示新的数据均值为0，方差为1，但是histgram显示出每个bin（默认10个）的数据数量没有变化。</p>
<div class="section" id="id2">
<h3>1.1 z-score证明<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>假设一组数据<span class="math notranslate nohighlight">\(\{X: x_1,x_2...x_n\}\)</span>的均值为<span class="math notranslate nohighlight">\(\mu=\sum_i^n\frac{x_i}{n}\)</span>，方差为<span class="math notranslate nohighlight">\(\sigma=\sum_i^n \frac{(x_i-\mu)^2}{n}\)</span>，经过z-score标准化的数据<span class="math notranslate nohighlight">\(\{Z: z_i=\frac{x_i-\mu}{\sigma}\}\)</span>。</p>
<p><span class="math notranslate nohighlight">\(Z\)</span>的均值
<span class="math notranslate nohighlight">\($\begin{aligned}E(Z) &amp;= \sum_i^n\frac{\frac{x_i-\mu}{\sigma}}{n}\\
&amp;= \sum_i^n\frac{x_i}{n\sigma} - \frac{\sum_i^n\mu}{n\sigma}\\
&amp;= \frac{\mu}{\sigma} - \frac{\mu}{\sigma}\\
&amp;= 0\end{aligned}\)</span>$</p>
<p><span class="math notranslate nohighlight">\(Z\)</span>的方差（已经得知<span class="math notranslate nohighlight">\(\mu_z=0\)</span>）
<span class="math notranslate nohighlight">\($\begin{aligned}V(Z) &amp;= \sum_i^n \frac{\left(\frac{(x_i-\mu)}{\sigma} - \mu_z\right)^2}{n}\\
&amp;= \frac{1}{\sigma^2}\sum_i^n\frac{(x_i-\mu)^2}{n}\\
&amp;= \frac{\sigma^2}{\sigma^2} = 1
\end{aligned}\)</span>$</p>
</div>
</div>
<div class="section" id="id3">
<h2>2 标准正太分布<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>对于正太分布<span class="math notranslate nohighlight">\(x \sim N\left(\mu, \sigma^{2}\right)\)</span>，其概率密度函数如下：</p>
<div class="math notranslate nohighlight">
\[f(x)=\frac{1}{\sqrt{2 \pi} \sigma} \exp \left(-\frac{(x-\mu)^{2}}{2 \sigma^{2}}\right)\]</div>
<p>如果<span class="math notranslate nohighlight">\(\mu=0, \sigma=1\)</span>，则称为标准正太分布<span class="math notranslate nohighlight">\(x \sim N\left(\mu, \sigma^{2}\right)\)</span>，概率密度函数简化为：</p>
<div class="math notranslate nohighlight">
\[f(x)=\frac{1}{\sqrt{2 \pi}} \exp \left(-\frac{x^2}{2}\right)\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">NormDist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">sigma</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">sigma</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">NormDist</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\frac</span><span class="si">{1}</span><span class="s1">{\sqrt{2\pi}\sigma}exp(\frac{-x^2}</span><span class="si">{2}</span><span class="s1">)$&#39;</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$exp(\frac{-x^2}</span><span class="si">{2}</span><span class="s1">)$&#39;</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$exp(-x^2)$&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/中心极限定理.jupyter_7_0.png" src="../_images/中心极限定理.jupyter_7_0.png" />
</div>
</div>
<p>从上图可以看出：1. 由于<span class="math notranslate nohighlight">\(-x^2\)</span>的存在使得在0点处左右对称，并且<span class="math notranslate nohighlight">\(x\)</span>越接近于0越大；2. 而<span class="math notranslate nohighlight">\(\frac{1}{\sqrt{2\pi}}\)</span>和<span class="math notranslate nohighlight">\(e\)</span>的指数除以<span class="math notranslate nohighlight">\(1/2\)</span>使得其面积（在x轴上积分）为1，满足了概率密度函数积分为1的性质。</p>
<div class="section" id="id4">
<h3>2.1 z-score变换为标准正态分布<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>正态分布<span class="math notranslate nohighlight">\(x \sim N\left(\mu, \sigma^{2}\right)\)</span>经过z-score标准化后会变成标准正态分布。证明过程如下</p>
<p>正态分布概率密度函数
<span class="math notranslate nohighlight">\($f(x)=\frac{1}{\sqrt{2 \pi} \sigma} \exp \left(-\frac{(x-\mu)^{2}}{2 \sigma^{2}}\right)\)</span>$</p>
<p>其精髓和意义就是通过对<span class="math notranslate nohighlight">\(f(x)\)</span>积分，可以得到<span class="math notranslate nohighlight">\(x\)</span>在任意区间的概率，例如<span class="math notranslate nohighlight">\(x&lt;k\)</span>的概率：</p>
<div class="math notranslate nohighlight">
\[P(x&lt;k)=\int_{-\infty}^{k} \frac{1}{\sqrt{2 \pi} \sigma} \exp \left(-\frac{(x-\mu)^{2}}{2 \sigma^{2}}\right) \mathrm{d} x\]</div>
<p>经过z-score标准化的新数据为<span class="math notranslate nohighlight">\(z=\frac{x-\mu}{\sigma}\)</span>，那么<span class="math notranslate nohighlight">\(z&lt;k\)</span>的概率：</p>
<div class="math notranslate nohighlight">
\[P(z &lt; k) = P\left(\frac{x-\mu}{\sigma}&lt;k\right) = P(x &lt; k\sigma + \mu)\]</div>
<p>将<span class="math notranslate nohighlight">\(k\sigma + \mu\)</span>代入积分公式，替换上限<span class="math notranslate nohighlight">\(k\)</span>：</p>
<div class="math notranslate nohighlight">
\[P(x &lt; k\sigma + \mu) = \int_{-\infty}^{k\sigma + \mu} \frac{1}{\sqrt{2 \pi} \sigma} \exp \left(-\frac{(x-\mu)^{2}}{2 \sigma^{2}}\right) \mathrm{d} x\]</div>
<p>可是我们要求的是<span class="math notranslate nohighlight">\(z &lt; k\)</span>的概率<span class="math notranslate nohighlight">\(P(z &lt; k)\)</span>，由于<span class="math notranslate nohighlight">\(P(z&lt;k) = P(x&lt;k\sigma + \mu)\)</span>，只需要将<span class="math notranslate nohighlight">\(x = z\sigma + \mu\)</span>只要代入积分公式替换掉<span class="math notranslate nohighlight">\(x\)</span>即可：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
P(z&lt;k) &amp;=\int_{-\infty}^{k} \frac{1}{\sqrt{2 \pi} \sigma} \exp \left(-\frac{(z \sigma+\mu-\mu)^{2}}{2 \sigma^{2}}\right) \sigma \mathrm{d} z \\
&amp;=\int_{\infty}^{k} \frac{1}{\sqrt{2 \pi}} \exp \left(-\frac{z^{2}}{2}\right) \mathrm{d} z
\end{aligned}\end{split}\]</div>
<blockquote>
<div><p>注意两点：</p>
<ol class="simple">
<li><p>积分<span class="math notranslate nohighlight">\(x\)</span>的上限为<span class="math notranslate nohighlight">\(x^*=k\sigma + \mu\)</span>，新变量<span class="math notranslate nohighlight">\(z\)</span>的上限为<span class="math notranslate nohighlight">\(\frac{x^*-\mu}{\sigma} = \frac{k\sigma + \mu - \mu}{\sigma} = k\)</span></p></li>
<li><p>对<span class="math notranslate nohighlight">\(x=z\sigma + \mu\)</span>两边求导，得到<span class="math notranslate nohighlight">\(dx=\sigma dz\)</span></p></li>
</ol>
</div></blockquote>
<p>至此，证明得到z-score变化后的数据服从标准正太分布<span class="math notranslate nohighlight">\(z \sim N(0, 1)\)</span>。</p>
</div>
</div>
<div class="section" id="id5">
<h2>3 中心极限定理<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>The central limit theorem in statistics states that, given a sufficiently large sample size, the sampling distribution of the mean for a variable will approximate a normal distribution regardless of that variable’s distribution in the population.</p>
<div class="section" id="id6">
<h3>3.1 名词解释<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>在统计学中，有一些专用名词不能弄混淆，特别是我们平时说的“样本”在这里并不是指单个数据，参见<a class="reference external" href="https://statisticsbyjim.com/basics/central-limit-theorem/">Central Limit Theorem Explained</a></p>
<ul class="simple">
<li><p>总体（population）：研究对象的整个群体（the complete set of all objects or people of interest）</p></li>
<li><p>样本（sample）：从总体中选取的一部分数据（a subset of the entire population）</p></li>
<li><p>样本数量（the number of samples）：有多少个样本。</p></li>
<li><p>样本大小/样本容量（sample size)：每个样本里包含多少个数据。</p></li>
<li><p>抽样分布（sampling distribution）：将样本平均值的分布可视化。</p></li>
</ul>
</div>
<div class="section" id="id7">
<h3>3.2 定义<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>对于独立同分布的变量<span class="math notranslate nohighlight">\(X_1, X_2, X_3 ... X_n\)</span>，其中<span class="math notranslate nohighlight">\(E(X_i)=\mu,\ V(X_i)=\sigma^2 &lt; \infty\)</span>，这组样本的均值表示为：</p>
<div class="math notranslate nohighlight">
\[\bar{X}_{n}:=\frac{X_{1}+\cdots+X_{n}}{n}\]</div>
<p>中心极限定理研究的就是这个<span class="math notranslate nohighlight">\(\bar{X_n}\)</span>的分布情况，而不是<span class="math notranslate nohighlight">\(X\)</span>的分布情况，因为现实中很多数据我们是无法获得其总体（population）分布情况的，而中心极限定理可以帮助我们分析其均值位置。</p>
<p>不同的<span class="math notranslate nohighlight">\(n\)</span>或者不同的样本都会影响<span class="math notranslate nohighlight">\(\bar{X_n}\)</span>，直觉上<span class="math notranslate nohighlight">\(\bar{X_n}\)</span>是和<span class="math notranslate nohighlight">\(E(X_i)\)</span>有关的，而且是围绕着<span class="math notranslate nohighlight">\(E(X_i)\)</span>的。如果对这组数据做z-score标准化得到<span class="math notranslate nohighlight">\(Y_n = (X_i-\mu)/\sigma\)</span>，标准化后的样本均值</p>
<div class="math notranslate nohighlight">
\[\bar{Y}_n = \frac{\sum_i^n(\frac{X_i - \mu}{\sigma})}{n}
= \sum_i^n{\frac{x_i}{n\sigma}} - \frac{\mu}{\sigma}\]</div>
<p>由大数定律（<a class="reference external" href="https://zhuanlan.zhihu.com/p/89557100">大数定律、中心极限定理与格里文科定理</a>）可知，当<span class="math notranslate nohighlight">\(n\rightarrow+\infty\)</span>时，<span class="math notranslate nohighlight">\(\{X_i, i=1,2,...,n\}\)</span>以概率1收敛于期望<span class="math notranslate nohighlight">\(\mu\)</span>，因此得到</p>
<div class="math notranslate nohighlight">
\[\lim_{n\rightarrow\infty} \bar{Y}_n \rightarrow 0\]</div>
<p>现在给出中心极限定理的定义：</p>
<div class="math notranslate nohighlight">
\[\lim _{n \rightarrow+\infty} P\left\{\frac{\bar{X_n}-\mu}{\sigma / \sqrt{n}} \leqslant x\right\}=\frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{x} e^{\frac{-t^{2}}{2}} d t\]</div>
<p>公式左边相当于对<span class="math notranslate nohighlight">\(\bar{X}_n\)</span>做了类似z-score的处理，减去总体均值<span class="math notranslate nohighlight">\(\mu\)</span>，并除以<span class="math notranslate nohighlight">\(\sigma/\sqrt{n}\)</span>，右边就是<strong>标准正态分布<span class="math notranslate nohighlight">\(N(0,1)\)</span><strong>的概率密度函数的积分，也就是说当</strong>样本容量极大时，样本均值的抽样分布趋近于期望为<span class="math notranslate nohighlight">\(\mu\)</span>，标准差为<span class="math notranslate nohighlight">\(\frac{\sigma}{\sqrt{n}}\)</span>的正态分布</strong>。如果将分子分母同乘以<span class="math notranslate nohighlight">\(n\)</span>，那么可以得到<span class="math notranslate nohighlight">\(X_i\)</span>和的表示形式</p>
<div class="math notranslate nohighlight">
\[\frac{\sum_{i=1}^{n} X_{i}-n \mu}{\sigma \sqrt{n}} \sim N(0,1)\]</div>
<p><a class="reference external" href="https://zhuanlan.zhihu.com/p/93738110">证明</a>过程将<span class="math notranslate nohighlight">\(\bar{X}_{norm}\)</span>的<a class="reference external" href="https://www.zhihu.com/question/23686709/answer/383239222">特征函数</a>在0点泰勒展开，得到了和标准正态分布<span class="math notranslate nohighlight">\(N(0, 1)\)</span>一样的特征函函数<span class="math notranslate nohighlight">\(e^{-\frac{t^2}{2}}\)</span>。</p>
</div>
<div class="section" id="id8">
<h3>3.3 单次采样<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id9">
<h4>3.3.1 均匀分布<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<p>以均匀分布<code class="docutils literal notranslate"><span class="pre">np.random.rand()</span></code>为例，一次采样1000个值，可以看到样本均值接近0.5，并且histgram（默认10个bin）中每个bin的值都接近<code class="docutils literal notranslate"><span class="pre">1000/10=100</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample_size</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># 采样个数</span>
<span class="n">number_of_sample</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># 采样次数</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">number_of_sample</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">)</span>

<span class="n">mean</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># sample values</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;sample values&#39;</span><span class="p">)</span>

<span class="c1"># histgram of X</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;histgram of $X$&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean:&#39;</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/中心极限定理.jupyter_10_0.png" src="../_images/中心极限定理.jupyter_10_0.png" />
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>mean: [0.49592153]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id10">
<h4>3.3.2 偏正态分布<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<p>如果用正态分布实验，结果可能不能很好的展示中心极限定理。我们直接用SciPy里的<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.skewnorm.html">skewnorm</a>偏正态分布，概率密度函数为<code class="docutils literal notranslate"><span class="pre">skewnorm.pdf(x,</span> <span class="pre">a)</span> <span class="pre">=</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">norm.pdf(x)</span> <span class="pre">*</span> <span class="pre">norm.cdf(a*x)</span></code>。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">skewnorm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">a</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">mean</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">skew</span><span class="p">,</span> <span class="n">kurt</span> <span class="o">=</span> <span class="n">skewnorm</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">moments</span><span class="o">=</span><span class="s1">&#39;mvsk&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">skewnorm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">a</span><span class="p">),</span> <span class="n">skewnorm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">a</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">skewnorm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;skewnorm pdf&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;E(X) =&#39;</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>E(X) = 0.7740617226446519
</pre></div>
</div>
<img alt="../_images/中心极限定理.jupyter_12_1.png" src="../_images/中心极限定理.jupyter_12_1.png" />
</div>
</div>
<p>打印的结果显示这个分布均值约等于0.774，我们采样1000个值看看其分布情况。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">skewnorm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># sample values</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;sample values&#39;</span><span class="p">)</span>

<span class="c1"># histgram of X</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;histgram of $X$&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean:&#39;</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>mean: 0.7426786528215207
</pre></div>
</div>
<img alt="../_images/中心极限定理.jupyter_14_1.png" src="../_images/中心极限定理.jupyter_14_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="id11">
<h3>3.4 多次采样<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id12">
<h4>3.4.1 均匀分布<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>我们分别测试<span class="math notranslate nohighlight">\(n=\{3, 10, 30, 100\}\)</span>的情况，每种情况都采集100000次，并画出每种情况下均值的分布图（已归一化）。从图中可以看出，虽然样本容量<span class="math notranslate nohighlight">\(n=3\)</span>很小，但是其均值的分布图已经是正态分布，这和均匀分布本身对称有关系。当<span class="math notranslate nohighlight">\(n=30\)</span>时候已经很好了。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span> <span class="c1"># 每次采样个数</span>
<span class="n">number_of_sample</span> <span class="o">=</span> <span class="mi">100000</span> <span class="c1"># 采样次数</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ss</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sample_size</span><span class="p">):</span>
    <span class="n">Xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">number_of_sample</span><span class="p">,</span> <span class="n">ss</span><span class="p">)</span>    
    <span class="n">h</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">Xs</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mf">2.</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;sample size = </span><span class="si">{</span><span class="n">ss</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fa9f3244a90&gt;
</pre></div>
</div>
<img alt="../_images/中心极限定理.jupyter_16_1.png" src="../_images/中心极限定理.jupyter_16_1.png" />
</div>
</div>
</div>
<div class="section" id="id13">
<h4>3.4.2 偏正态分布<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<p>同均匀分布一样，仍然测试<span class="math notranslate nohighlight">\(n=\{3, 10, 30, 100\}\)</span>的情况，但是注意，由于样本容量<span class="math notranslate nohighlight">\(n=3\)</span>太小，其均值分布类似于总体数据的偏正态分布，而<span class="math notranslate nohighlight">\(n=10\)</span>就好了很多。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span> <span class="c1"># 每次采样个数</span>
<span class="n">number_of_sample</span> <span class="o">=</span> <span class="mi">100000</span> <span class="c1"># 采样次数</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ss</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sample_size</span><span class="p">):</span>
    <span class="n">Xs</span> <span class="o">=</span> <span class="n">skewnorm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">number_of_sample</span><span class="p">,</span> <span class="n">ss</span><span class="p">))</span>
    <span class="n">h</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">Xs</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mf">2.</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;sample size = </span><span class="si">{</span><span class="n">ss</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fa9f31ce358&gt;
</pre></div>
</div>
<img alt="../_images/中心极限定理.jupyter_18_1.png" src="../_images/中心极限定理.jupyter_18_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="id14">
<h3>3.5 练习题<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<p>e.g.1 某炮兵阵地对敌人的防御地段进行100次射击，每次射击中炮弹的命中数是一个随机变量，其期望为2，方差为1.69，求在100次射击中有180颗到220颗炮弹命中目标的概率。</p>
<p>解：设<span class="math notranslate nohighlight">\(X_i\)</span>表示第<span class="math notranslate nohighlight">\(i\)</span>次设计命中的炮弹数，则<span class="math notranslate nohighlight">\(E(X_i)=2,\ D(X_i)=1.69\)</span>，因为100很大，所以根据中心极限定理可以认为<span class="math notranslate nohighlight">\(\frac{(S_{100}-100\mu)}{\sqrt{100}\sigma}\)</span>近似服从<span class="math notranslate nohighlight">\(N(0,1)\)</span>，<span class="math notranslate nohighlight">\(100\mu=200\ \sigma=1.3\)</span>，所以</p>
<div class="math notranslate nohighlight">
\[\begin{split}P\left(180 \leq S_{n} \leq 220\right) = P\left(\frac{180-200}{13} \leq \frac{S_{n}-200}{13} \leq \frac{220-200}{13}\right)\\
\approx \varnothing\left(\frac{20}{13}\right)-\varnothing\left(-\frac{20}{13}\right)\\
= 2\varnothing(1.54) - 1 = 0.8764\end{split}\]</div>
</div>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="Math.jupyter.html" title="previous page">Math</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Austin.Dawei<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>